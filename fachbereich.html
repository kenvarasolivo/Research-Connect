<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Research Connect ‚Äì Fachbereiche</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div class="container">
  <aside class="sidebar">
    <div class="sidebar-header"></div>

    <div class="search-box" style="position: relative;">
      <input type="text" placeholder="Search..." />
      <span class="search-icon">üîç</span>
    </div>

    <div class="user-area" id="userArea" style="display: none;">
      <p class="user-name">Willkommen, <span id="usernameDisplay">Benutzer</span></p>
      <ul class="user-links" id="userLinks">
        <!-- Links werden per JS gesetzt -->
      </ul>
    </div>
  </aside>

  <main class="main-content">
    <header class="main-header">
      <h1><a href="#">Research Connect</a></h1>
      <nav class="nav">
        <a href="Index.html">Home</a>
        <a href="projekt.html">Projekte</a>
        <a href="personen.html">Personen</a>
        <a href="fachbereich.html">Fachbereiche</a>
        <a href="login.html" id="login-link">Login üîê</a>
        <span id="user-display"></span>
      </nav>
    </header>

    <div class="fachbereich-flex">
      <section class="fachbereiche">
        <h2>Fachbereiche</h2>
        <ul class="fachbereich-liste">
          <li><a href="#">Fachbereich 1: Architektur</a><br />
            Konzentriert sich auf die Planung und Gestaltung von Bauwerken...
          </li>
          <li><a href="#">Fachbereich 2: Bauingenieurwesen</a><br />
            Bietet eine praxisnahe Ausbildung in Bereichen wie Konstruktiver Ingenieurbau, Baubetrieb und Umwelttechnik...
          </li>
          <li><a href="#">Fachbereich 3: Chemie und Biotechnologie</a><br />
            Fokussiert auf angewandte Chemie und Biotechnologie mit modernen Laboren...
          </li>
          <li><a href="#">Fachbereich 4: Gestaltung</a><br />
            Vereint Studieng√§nge wie Kommunikationsdesign und Produktdesign...
          </li>
          <li><a href="fachbereich5_detail.html">Fachbereich 5: Elektrotechnik und Informationstechnik</a><br />
            Deckt Elektrotechnik, Informatik und verwandte Disziplinen ab...
          </li>
          <li><a href="#">Fachbereich 6: Luft- und Raumfahrttechnik</a><br />
            Spezialisiert auf die Entwicklung und Konstruktion von Luft- und Raumfahrtsystemen...
          </li>
          <li><a href="#">Fachbereich 7: Maschinenbau und Mechatronik</a><br />
            Bietet Studieng√§nge rund um Maschinenbau, Mechatronik und Produktionstechnik...
          </li>
          <li><a href="#">Fachbereich 8: Medizintechnik und Technomathematik</a><br />
            Verbindet Medizintechnik, Mathematik und Informatik f√ºr innovative L√∂sungen...
          </li>
          <li><a href="#">Fachbereich 9: Wirtschaftswissenschaften</a><br />
            Umfasst Betriebswirtschaft, Wirtschaftsingenieurwesen und Wirtschaftsinformatik...
          </li>
          <li><a href="#">Fachbereich 10: Energietechnik</a><br />
            Fokussiert auf Energieversorgung, erneuerbare Energien und Energiemanagement...
          </li>
          <li><a href="#">Fachbereich 11: Bau- und Umweltingenieurwesen</a><br />
            Besch√§ftigt sich mit nachhaltigem Bauen, Umwelttechnik und Infrastruktur...
          </li>
        </ul>
      </section>
      <div class="fachbereich-bilder">
        <img src="images/fachbereich1.jpg" alt="Fachbereich Architektur" />
        <img src="images/fachbereich2.jpg" alt="Fachbereich Bauingenieurwesen" />
        <img src="images/fachbereich3.jpg" alt="Fachbereich Geb√§ude" />
      </div>
    </div>
  </main>

  <aside class="right-logo">
    <img src="images/fh banner.png" />
  </aside>
</div>

<script>
  console.log(localStorage);
  document.addEventListener("DOMContentLoaded", () => {
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    const username = localStorage.getItem('username') || 'Benutzer';
    const role = localStorage.getItem('role') || 'student';

    const userArea = document.getElementById('userArea');
    const usernameDisplay = document.getElementById('usernameDisplay');
    const loginLink = document.getElementById('login-link');
    const userDisplay = document.getElementById('user-display');
    const userLinks = document.getElementById('userLinks');

    if (isLoggedIn) {
      userArea.style.display = 'block';
      usernameDisplay.textContent = username;

      if (role === 'staff') {
        userLinks.innerHTML = `
            <li><a href="mitarbeiter_profil.html">üë§ Mitarbeiter-Profil</a></li>
            <li><a href="projekterstellung.html">‚ûï Projekt erstellen</a></li>
            <li><a href="eigene_projekte.html">üìÅ Eigene Projekte</a></li>
          `;
      } else {
        userLinks.innerHTML = `
            <li><a href="profil.html">üë§ Profil</a></li>
            <li><a href="projekterstellung.html">‚ûï Projekt erstellen</a></li>
            <li><a href="eigene_projekte.html">üìÅ Eigene Projekte</a></li>
          `;
      }

      loginLink.textContent = 'Abmelden üîì';
      loginLink.href = '#';
      loginLink.addEventListener('click', (e) => {
        e.preventDefault();
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('username');
        location.reload();
      });

      userDisplay.innerHTML = `Hallo, <strong>${username}</strong>`;
    } else {
      userArea.style.display = 'none';
      loginLink.textContent = 'Login üîê';
      loginLink.href = 'login.html';
      userDisplay.textContent = '';
    }

    // F√∂rderprogramme mit korrekten Links
    const foerderProjekte = [
      { titel: "Talentf√∂rderung f√ºr Sch√ºler:innen", link: "Talentf√∂derung1.html" },
      { titel: "Startup Lab F√∂rderprogramm", link: "Startup-Lab-F√∂rderprogramm.html" },
      { titel: "Frauen in Forschung & Technik", link: "Frauen-in-Forschung&Technik.html" },
      { titel: "Internationale F√∂rderung", link: "Internationale-F√∂rderung.html" },
      { titel: "Soziale Innovation f√∂rdern", link: "Soziale-Innovation-f√∂rdern.html" }
    ];

    const searchInput = document.querySelector(".search-box input");

    searchInput.addEventListener("input", function () {
      const query = this.value.toLowerCase();

      // Filter F√∂rderprogramme
      const matchingFoerder = foerderProjekte.filter(p =>
              p.titel.toLowerCase().includes(query)
      );

      // Projekte aus LocalStorage suchen
      const projektKeys = JSON.parse(localStorage.getItem("projekte_liste") || "[]");

      const matchingProjects = projektKeys
              .map(key => JSON.parse(localStorage.getItem("projekt_" + key)))
              .filter(projekt =>
                      projekt &&
                      (projekt.titel?.toLowerCase().includes(query) ||
                              projekt.thema?.toLowerCase().includes(query) ||
                              projekt.beschreibung?.toLowerCase().includes(query) ||
                              projekt.fachbereich?.toLowerCase().includes(query))
              );

      showSearchResults(matchingFoerder, matchingProjects);
    });

    function showSearchResults(foerderResults, projektResults) {
      let resultBox = document.getElementById("search-results");
      if (!resultBox) {
        resultBox = document.createElement("div");
        resultBox.id = "search-results";
        resultBox.style.position = "absolute";
        resultBox.style.background = "#fff";
        resultBox.style.border = "1px solid #ccc";
        resultBox.style.maxHeight = "200px";
        resultBox.style.overflowY = "auto";
        resultBox.style.zIndex = 1000;
        resultBox.style.width = "100%";
        resultBox.style.top = "100%";
        resultBox.style.left = "0";
        resultBox.style.fontSize = "14px";
        resultBox.style.boxShadow = "0 2px 4px rgba(0,0,0,0.1)";
        searchInput.parentNode.appendChild(resultBox);
      }

      resultBox.innerHTML = "";

      if (foerderResults.length === 0 && projektResults.length === 0) {
        resultBox.innerHTML = "<p style='margin:8px;'>Keine Treffer</p>";
        return;
      }

      foerderResults.forEach(p => {
        const div = document.createElement("div");
        div.textContent = p.titel;
        div.onclick = () => window.location.href = p.link;
        div.addEventListener("mouseover", () => div.style.backgroundColor = "#f0f0f0");
        div.addEventListener("mouseout", () => div.style.backgroundColor = "#fff");
        div.style.padding = "8px";
        div.style.borderBottom = "1px solid #eee";
        div.style.cursor = "pointer";
        resultBox.appendChild(div);
      });

      projektResults.forEach(projekt => {
        const div = document.createElement("div");
        div.textContent = `${projekt.titel} ‚Äì ${projekt.fachbereich}`;
        div.onclick = () => window.location.href = `projekt_uebersicht.html?titel=${encodeURIComponent(projekt.titel)}`;
        div.addEventListener("mouseover", () => div.style.backgroundColor = "#f0f0f0");
        div.addEventListener("mouseout", () => div.style.backgroundColor = "#fff");
        div.style.padding = "8px";
        div.style.borderBottom = "1px solid #eee";
        div.style.cursor = "pointer";
        resultBox.appendChild(div);
      });
    }
  });
</script>
</body>
</html>
